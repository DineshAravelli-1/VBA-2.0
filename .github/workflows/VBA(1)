Sub UploadDataToSharePoint()
    Dim ctx As Object
    Dim list As Object
    Dim listItemInfo As Object
    Dim listItem As Object
    Dim i As Long

    ' Create context and authenticate
    Set ctx = CreateObject("ScriptControl")
    ctx.Language = "JScript"
    ctx.AddCode "function getAuth(url) {var auth = new SP.ClientContext(url); return auth;}"

    ' Update with your SharePoint site URL
    Set ctx = ctx.Run("getAuth", "https://yoursite.sharepoint.com/")
    
    ' Get the SharePoint list
    Set list = ctx.Web.Lists.GetByTitle("Your List Name")

    ' Add items from Excel to SharePoint List
    For i = 2 To Sheet1.Cells(Rows.Count, 1).End(xlUp).Row
        Set listItemInfo = SP.ListItemCreationInformation
        Set listItem = list.AddItem(listItemInfo)
        listItem("Title") = Sheet1.Cells(i, 1).Value
        listItem("ColumnName") = Sheet1.Cells(i, 2).Value
        listItem.Update()
        ctx.ExecuteQuery()
    Next i

    MsgBox "Data uploaded successfully!"
End Sub
