Sub UploadDataToSharePoint()
    Dim xml As Object
    Dim url As String
    Dim i As Long
    Dim jsonBody As String

    ' Create an XMLHTTP object
    Set xml = CreateObject("MSXML2.XMLHTTP.6.0")

    ' SharePoint REST API URL to your list
    url = "https://yoursite.sharepoint.com/_api/web/lists/getbytitle('Your List Name')/items"

    ' Loop through each row in Excel starting from row 2
    For i = 2 To Sheet1.Cells(Rows.Count, 1).End(xlUp).Row
        ' Prepare JSON body for the HTTP POST request
        jsonBody = "{ '__metadata': { 'type': 'SP.Data.YourListNameListItem' }, " & _
                   "'Title': '" & Sheet1.Cells(i, 1).Value & "', " & _
                   "'ColumnName': '" & Sheet1.Cells(i, 2).Value & "'}"

        ' Send a POST request to SharePoint
        With xml
            .Open "POST", url, False
            .SetRequestHeader "Content-Type", "application/json;odata=verbose"
            .SetRequestHeader "Accept", "application/json;odata=verbose"
            .SetRequestHeader "X-RequestDigest", GetFormDigest()
            .Send jsonBody
        End With

        ' Check response
        If xml.Status <> 201 Then
            MsgBox "Error: " & xml.Status & " - " & xml.statusText
            Exit Sub
        End If
    Next i

    MsgBox "Data uploaded successfully!"
End Sub

Function GetFormDigest() As String
    Dim xml As Object
    Dim url As String

    Set xml = CreateObject("MSXML2.XMLHTTP.6.0")
    url = "https://yoursite.sharepoint.com/_api/contextinfo"
    
    With xml
        .Open "POST", url, False
        .SetRequestHeader "Content-Type", "application/json;odata=verbose"
        .SetRequestHeader "Accept", "application/json;odata=verbose"
        .Send
    End With
    
    If xml.Status = 200 Then
        GetFormDigest = Split(Split(xml.responseText, "FormDigestValue"":""")(1), """")(0)
    Else
        MsgBox "Failed to get Form Digest: " & xml.Status & " - " & xml.statusText
        GetFormDigest = ""
    End If
End Function
